"use strict";var myMap,intervalId,soundLevel,slider=$(".slider__list").bxSlider({pager:!1,controls:!1}),hamburger=($(".slider__arrow--prev").on("click",function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".slider__arrow--next").on("click",function(e){e.preventDefault(),slider.goToNextSlide()}),document.querySelector("#hamburger")),menu=document.querySelector("#fullscreenMenu"),init=(hamburger.addEventListener("click",function(e){e.preventDefault(),hamburger.classList.toggle("hamburger--active"),menu.classList.toggle("menu--active"),pageScroll.toggleBlock()}),menu.addEventListener("click",function(e){e.preventDefault(),hamburger.classList.remove("hamburger--active"),menu.classList.remove("menu--active"),pageScroll.unblock()}),function(){myMap=new ymaps.Map("map",{center:[55.752004,37.576133],zoom:14});var e=new ymaps.Placemark([55.752004,37.576133],{},{iconLayout:"default#image",iconImageHref:"img/map/placemark.png",iconImageSize:[58,73],iconImageOffset:[-20,-60]});myMap.geoObjects.add(e),myMap.behaviors.disable("drag")}),validateFields=(ymaps.ready(init),function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length}),part=($(".form").on("submit",function(e){e.preventDefault();var e=$(e.currentTarget),t=e.find("[name='name']"),n=e.find("[name='phone']"),o=e.find("[name='comment']"),i=e.find("[name='to']"),a=$("#modal"),r=a.find(".modal__content");a.removeClass("error-modal"),validateFields(e,[t,n,o])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:t.val(),phone:n.val(),comment:o.val(),to:i.val()}})).done(function(e){r.text(e.message)}),e.fail(function(e){e=e.responseJSON.message;r.text(e),a.addClass("error-modal")}),e.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".app-submit-button").on("click",function(e){e.preventDefault(),$.fancybox.close()}),$("section")),show=$(".maincontent"),fixedMenu=$(".fixed-menu"),menuItems=fixedMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1,countSectionPosition=(part.first().addClass("active"),function(e){e*=-100;return isNaN(e)?(console.error("передано не верное значение в countSectionPosition"),0):e}),changeMenuThemeForSection=function(e){var t="fixed-menu--dark";"black"==part.eq(e).attr("data-fixed-menu")?fixedMenu.addClass(t):fixedMenu.removeClass(t)},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass(n)},startTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),show.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(part,e,"active"),setTimeout(function(){inScroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active")},600))},viewportScroller=function(){var e=part.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&startTransition(t.index())},prev:function(){n.length&&startTransition(n.index())}}},sections=($(window).on("wheel",function(e){var e=e.originalEvent.deltaY,t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"==t||"textarea"==t,n=viewportScroller();if(!t)switch(e.keyCode){case 38:n.prev();break;case 40:n.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to").on("click",function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));startTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){viewportScroller()["down"==t?"prev":"up"==t?"next":""]()}}),$(".section")),display=$(".maincontent"),inscroll=!1,switchActiveClassSideMenu=function(e){$(".fixed-menu__item").eq(e).addClass("active").siblings().removeClass("active")},performTransition=function(e){var t;pageScroll.isBlocked()||inscroll||(inscroll=!0,t="".concat(-100*e,"%"),sections.eq(e).addClass("active").siblings().removeClass("active"),display.css({transform:"translateY(".concat(t,")")}),setTimeout(function(){switchActiveClassSideMenu(e),inscroll=!1},1300))},commentAvatars=document.querySelector("#commentAvatars"),findReview=function(e){document.querySelector(".reviews__display-inner.active").classList.remove("active"),document.querySelector('.reviews__display-inner[data-item="'.concat(e,'"]')).classList.add("active")},openItem=(commentAvatars.addEventListener("click",function(e){e.preventDefault();var t,e=e.target;e.classList.contains("interactive-avatar__img")&&((t=document.querySelector(".interactive-avatar--active"))&&t.classList.remove("interactive-avatar--active"),e=(t=e.parentElement).parentElement,t=t.getAttribute("data-open"),e.classList.add("interactive-avatar--active"),findReview(t))}),function(e){var e=e.closest(".team__item"),t=e.find(".team__content"),n=t.find(".team__content-block").height();e.addClass("active"),t.height(n)}),closeEveryItem=function(e){var t=e.find(".team__content");e.find(".team__item").removeClass("active"),t.height(0)},playButton=($(".team__title").on("click",function(e){var e=$(e.currentTarget),t=e.closest(".team"),n=e.closest(".team__item"),o=e.find(".triangle");n.hasClass("active")?(closeEveryItem(t),o.removeClass("triangle--active")):(closeEveryItem(t),openItem(e),o.addClass("triangle--active"))}),document.querySelector(".video__player-img")),video=document.getElementById("player"),playerPlayButton=document.querySelector(".duration__img"),durationControl=document.getElementById("durationLevel"),soundControl=document.getElementById("soundLevel"),soundButton=document.getElementById("soundButton"),dynamicButton=document.getElementById("dynamic");function playStop(){playButton.classList.toggle("video__player-img--active"),playerPlayButton.classList.toggle("duration__img--active"),video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/60)):(clearInterval(intervalId),video.pause())}function setVideoDuration(){video.currentTime=durationControl.value,updateDuration()}function updateDuration(){durationControl.value=video.currentTime;var e=video.duration/100,e=video.currentTime/e;durationControl.style.background="linear-gradient(90deg, #FEDB3F 0% ".concat(e,"%, #626262 ").concat(e,"%)")}function changeSoundVolume(){video.volume=soundControl.value/10,0==video.volume?soundButton.classList.add("sound--active"):soundButton.classList.remove("sound--active")}function soundOff(){0==video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel,soundButton.classList.remove("sound--active")):(soundLevel=video.volume,video.volume=0,soundControl.value=0,soundButton.classList.add("sound--active"))}video.addEventListener("loadeddata",function(){video.addEventListener("click",playStop);for(var e=document.querySelectorAll(".play"),t=0;t<e.length;t++)e[t].addEventListener("click",playStop);durationControl.min=0,durationControl.value=0,durationControl.max=video.duration,durationControl.addEventListener("input",setVideoDuration),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max,soundControl.addEventListener("input",changeSoundVolume),dynamicButton.addEventListener("click",soundOff),console.log("click"),video.addEventListener("ended",function(){playButton.classList.toggle("video__player-img--active"),playerPlayButton.classList.remove("duration__img--active"),video.currentTime=0})}),$('input[type="range"]').change(function(){var e=($(this).val()-$(this).attr("min"))/($(this).attr("max")-$(this).attr("min"));$(this).css("background-image","-webkit-gradient(linear, left top, right top, color-stop("+e+", yellow), color-stop("+e+", grey))")});var vmenu=document.querySelector("#horizontalMenu"),items=document.querySelectorAll(".vmenu__item"),getItemWidth=function(e){var t=524,n=window.innerWidth,e=e.offsetWidth,o=window.matchMedia("(max-width: 768px)").matches,i=window.matchMedia("(max-width: 480px)").matches;return o&&(t=n-e*items.length),t=i?n-e:t},setItemWidth=function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],e=e.nextElementSibling,o=e.firstElementChild;e.style.width="".concat(t,"px"),n&&(o.style.width="".concat(t,"px"))},closeItem=function(e){e.parentElement.classList.remove("vmenu__item--active"),e.classList.remove("vmenu__button--active"),setItemWidth(e,0,!1)},openMenuItem=function(e){e.parentElement.classList.add("vmenu__item--active"),e.classList.add("vmenu__button--active");var t=getItemWidth(e);setItemWidth(e,t)};vmenu.addEventListener("click",function(e){e.preventDefault();var e=e.target,t=e.classList.contains("vmenu__button--active"),n=document.querySelector(".vmenu__button--active");e.classList.contains("vmenu__button")&&t&&(n&&closeItem(n),console.log("close")),e.classList.contains("vmenu__button")&&!t&&(n&&closeItem(n),openMenuItem(e),console.log("open"))}),window.addEventListener("resize",function(){var e=document.querySelector(".vmenu__button--active");e&&closeItem(e)});